#line 1 "/usr/share/selinux/devel/include/support/all_perms.spt"







































































































































#line 239


#line 274

#line 1 "/usr/share/selinux/devel/include/support/file_patterns.spt"
#
# Directory patterns (dir)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. directory type
#
#line 12


#line 17


#line 22


#line 27


#line 32


#line 37


#line 42


#line 47


#line 52


#line 57


#line 62


#line 67


#line 72


#line 77


#line 82

#line 86

#line 90

#line 94

#line 98


#
# Regular file patterns (file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 111


#line 116


#line 121


#line 126


#line 133


#line 138


#line 143


#line 148


#line 153


#line 158


#line 163


#line 168


#line 173


#line 178


#line 183


#line 188


#line 193


#line 198


#line 203


#
# Symbolic link patterns (lnk_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 216


#line 221


#line 226


#line 231


#line 236


#line 241


#line 246


#line 251


#line 256


#line 261


#line 266


#line 271


#line 276


#line 281


#
# (Un)named Pipes/FIFO patterns (fifo_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 294


#line 299


#line 304


#line 309


#line 314


#line 319


#line 324


#line 329


#line 334


#line 339


#line 344


#line 349


#line 354


#line 359


#
# (Un)named sockets patterns (sock_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 372


#line 377


#line 382


#line 387


#line 392


#line 397


#line 402


#line 407


#line 412


#line 417


#line 422


#line 427


#line 432


#
# Block device node patterns (blk_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 445


#line 450


#line 455


#line 460


#line 465


#line 470


#line 475


#line 481


#line 486


#line 491


#line 497


#line 502


#line 507


#line 512


#line 517


#
# Character device node patterns (chr_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 530


#line 535


#line 540


#line 545


#line 550


#line 555


#line 561


#line 566


#line 571


#line 577


#line 582


#line 587


#line 592


#line 597


#
# File type_transition patterns
#
# filetrans_add_pattern(domain,dirtype,newtype,class(es),[filename])
#
#line 607


#
# filetrans_pattern(domain,dirtype,newtype,class(es),[filename])
#
#line 615


#line 629

#line 1 "/usr/share/selinux/devel/include/support/ipc_patterns.spt"
#
# unix domain socket patterns
#
#line 8


#line 14

#line 1 "/usr/share/selinux/devel/include/support/loadable_module.spt"
########################################
#
# Macros for switching between source policy
# and loadable policy module support
#

##############################
#
# For adding the module statement
#
#line 30


##############################
#
# For use in interfaces, to optionally insert a require block
#
#line 48


# helper function, since m4 wont expand macros
# if a line is a comment (#):
#line 55

##############################
#
# In the future interfaces should be in loadable modules
#
# template(name,rules)
#
#line 71


##############################
#
# In the future interfaces should be in loadable modules
#
# interface(name,rules)
#
#line 88




##############################
#
# Optional policy handling
#
#line 102


##############################
#
# Determine if we should use the default
# tunable value as specified by the policy
# or if the override value should be used
#


##############################
#
# Extract booleans out of an expression.
# This needs to be reworked so expressions
# with parentheses can work.

#line 123


##############################
#
# Tunable declaration
#
#line 131


##############################
#
# Tunable policy handling
#
#line 146

#line 1 "/usr/share/selinux/devel/include/support/misc_macros.spt"

########################################
#
# Helper macros
#

#
# shiftn(num,list...)
#
# shift the list num times
#


#
# ifndef(expr,true_block,false_block)
#
# m4 does not have this.
#


#
# __endline__
#
# dummy macro to insert a newline.  used for 
# errprint, so the close parentheses can be
# indented correctly.
#
#line 29


########################################
#
# refpolwarn(message)
#
# print a warning message
#


########################################
#
# refpolerr(message)
#
# print an error message.  does not
# make anything fail.
#


########################################
#
# gen_user(username, prefix, role_set, mls_defaultlevel, mls_range, [mcs_categories])
#
#line 58


########################################
#
# gen_context(context,mls_sensitivity,[mcs_categories])
#
#line 65

########################################
#
# can_exec(domain,executable)
#


########################################
#
# gen_bool(name,default_value)
#
#line 78

#line 1 "/usr/share/selinux/devel/include/support/misc_patterns.spt"
#
# Specified domain transition patterns
#
#line 8


# compatibility:


#line 20


#
# Automatic domain transition patterns
#
#line 28


# compatibility:


#line 39


#
# Dynamic transition pattern
#
#line 48


#
# Other process permissions
#
#line 58

#line 1 "/usr/share/selinux/devel/include/support/mls_mcs_macros.spt"
########################################
#
# gen_cats(N)
#
# declares categores c0 to c(N-1)
#
#line 10




########################################
#
# gen_sens(N)
#
# declares sensitivites s0 to s(N-1) with dominance
# in increasing numeric order with s0 lowest, s(N-1) highest
#
#line 24




#line 34


########################################
#
# gen_levels(N,M)
#
# levels from s0 to (N-1) with categories c0 to (M-1)
#
#line 45




########################################
#
# Basic level names for system low and high
#





#line 1 "/usr/share/selinux/devel/include/support/obj_perm_sets.spt"
########################################
# 
# Support macros for sets of object classes and permissions
#
# This file should only have object class and permission set macros - they
# can only reference object classes and/or permissions.

#
# All directory and file classes
#


#
# All non-directory file classes.
#


#
# Non-device file classes.
#


#
# Device file classes.
#


#
# All socket classes.
#


#
# Datagram socket classes.
# 


#
# Stream socket classes.
#


#
# Unprivileged socket classes (exclude rawip, netlink, packet).
#


########################################
# 
# Macros for sets of permissions
#

#
# Permissions to mount and unmount file systems.
#


#
# Permissions for using sockets.
# 


#
# Permissions for creating and using sockets.
# 


#
# Permissions for using stream sockets.
# 


#
# Permissions for creating and using stream sockets.
# 


#
# Permissions for creating and using sockets.
# 


#
# Permissions for creating and using sockets.
# 



#
# Permissions for creating and using netlink sockets.
# 


#
# Permissions for using netlink sockets for operations that modify state.
# 


#
# Permissions for using netlink sockets for operations that observe state.
# 


#
# Permissions for sending all signals.
#


#
# Permissions for sending and receiving network packets.
#


#
# Permissions for using System V IPC
#










########################################
#
# New permission sets
#

#
# Directory (dir)
#




















#
# Regular file (file)
#




























#
# Symbolic link (lnk_file)
#















#
# (Un)named Pipes/FIFOs (fifo_file)
#

















#
# (Un)named Sockets (sock_file)
#















#
# Block device nodes (blk_file)
#

















#
# Character device nodes (chr_file)
#

















#
# Anonymous inode files (anon_inode)
#
#line 289

#line 294


########################################
#
# Special permission sets
#

#
# Use (read and write) terminals
#



#
# Sockets
#



#
# Keys
#


#
# Service
#


#
# perf_event
#



#line 421859 "tmp/all_interfaces.conf"

#line 1 "secure_app_user_home2.te"

module secure_app_user_home2 1.0;

require {
	type chronyd_t;
	type init_t;
	type secure_app_t;
	type unconfined_t;
	type unconfined_service_t;
	type NetworkManager_t;
	type cupsd_t;
	type rtkit_daemon_t;
	type unconfined_dbusd_t;
	type abrt_dump_oops_t;
	type systemd_homed_t;
	type secure_app_data_t;
	type tuned_t;
	type systemd_machined_t;
	type modemmanager_t;
	type firewalld_t;
	type systemd_resolved_t;
	type fsdaemon_t;
	type system_dbusd_t;
	type kernel_t;
	type user_home_dir_t;
	type syslogd_t;
	type devicekit_power_t;
	type bin_t;
	type setroubleshootd_t;
	type container_runtime_t;
	type udev_t;
	type user_home_t;
	type policykit_t;
	type sssd_t;
	type fs_t;
	type proc_t;
	type geoclue_t;
	type systemd_userdbd_t;
	type shell_exec_t;
	type devicekit_disk_t;
	type accountsd_t;
	type user_devpts_t;
	type systemd_logind_t;
	type xdm_t;
	type secure_app_exec_t;
	type sysfs_t;
	type devpts_t;
	type xserver_t;
	type avahi_t;
	type alsa_t;
	type gssproxy_t;
	type colord_t;
	type systemd_nsresourced_t;
	type pcscd_t;
	type auditd_t;
	class file { entrypoint execute execute_no_trans getattr map open read relabelfrom relabelto };
	class chr_file { append getattr ioctl read write };
	class dir { getattr open read relabelfrom relabelto search };
	class filesystem associate;
	class capability { dac_override dac_read_search };
	class process { getattr transition };
	class capability2 mac_admin;
}

#============= secure_app_data_t ==============
allow secure_app_data_t fs_t:filesystem associate;

#============= secure_app_t ==============
allow secure_app_t NetworkManager_t:dir { getattr search };
allow secure_app_t abrt_dump_oops_t:dir { getattr search };
allow secure_app_t accountsd_t:dir getattr;
allow secure_app_t alsa_t:dir { getattr search };
allow secure_app_t auditd_t:dir { getattr search };
allow secure_app_t avahi_t:dir { getattr search };

#!!!! This avc is allowed in the current policy
allow secure_app_t bin_t:file { execute execute_no_trans };
allow secure_app_t chronyd_t:dir { getattr search };
allow secure_app_t colord_t:dir { getattr search };
allow secure_app_t container_runtime_t:dir getattr;
allow secure_app_t cupsd_t:dir { getattr search };
allow secure_app_t devicekit_disk_t:dir { getattr search };
allow secure_app_t devicekit_power_t:dir getattr;
allow secure_app_t devpts_t:dir search;
allow secure_app_t firewalld_t:dir { getattr search };

#!!!! This avc is allowed in the current policy
allow secure_app_t fs_t:filesystem associate;
allow secure_app_t fsdaemon_t:dir getattr;
allow secure_app_t geoclue_t:dir { getattr search };
allow secure_app_t gssproxy_t:dir { getattr search };
allow secure_app_t init_t:dir { getattr search };
allow secure_app_t kernel_t:dir { getattr search };
allow secure_app_t modemmanager_t:dir { getattr search };
allow secure_app_t pcscd_t:dir { getattr search };
allow secure_app_t policykit_t:dir { getattr search };

#!!!! This avc is allowed in the current policy
allow secure_app_t proc_t:dir read;

#!!!! This avc is allowed in the current policy
allow secure_app_t proc_t:file read;
allow secure_app_t proc_t:file { getattr open };
allow secure_app_t rtkit_daemon_t:dir { getattr search };

#!!!! This avc is allowed in the current policy
allow secure_app_t self:capability dac_override;
allow secure_app_t self:capability dac_read_search;
allow secure_app_t self:process getattr;
allow secure_app_t setroubleshootd_t:dir getattr;

#!!!! This avc is allowed in the current policy
allow secure_app_t shell_exec_t:file { execute map };
allow secure_app_t sssd_t:dir getattr;

#!!!! This avc is allowed in the current policy
allow secure_app_t sysfs_t:dir read;

#!!!! This avc is allowed in the current policy
allow secure_app_t sysfs_t:file read;
allow secure_app_t sysfs_t:file open;
allow secure_app_t syslogd_t:dir { getattr search };
allow secure_app_t system_dbusd_t:dir { getattr search };
allow secure_app_t systemd_homed_t:dir getattr;
allow secure_app_t systemd_logind_t:dir { getattr search };
allow secure_app_t systemd_machined_t:dir { getattr search };
allow secure_app_t systemd_nsresourced_t:dir { getattr search };
allow secure_app_t systemd_resolved_t:dir { getattr search };
allow secure_app_t systemd_userdbd_t:dir { getattr search };
allow secure_app_t tuned_t:dir { getattr search };
allow secure_app_t udev_t:dir { getattr search };
allow secure_app_t unconfined_dbusd_t:dir getattr;
allow secure_app_t unconfined_service_t:dir { getattr search };
allow secure_app_t unconfined_t:dir { getattr search };

#!!!! This avc is allowed in the current policy
#!!!! This av rule may have been overridden by an extended permission av rule
allow secure_app_t user_devpts_t:chr_file { append getattr ioctl read write };

#!!!! This avc is allowed in the current policy
allow secure_app_t user_home_dir_t:dir { getattr search };

#!!!! This avc is allowed in the current policy
allow secure_app_t user_home_t:dir { getattr search };
allow secure_app_t user_home_t:dir { open read };
allow secure_app_t xdm_t:dir { getattr search };
allow secure_app_t xserver_t:dir getattr;

#============= unconfined_t ==============

#!!!! This avc is allowed in the current policy
allow unconfined_t secure_app_data_t:dir { getattr open read relabelfrom relabelto search };

#!!!! This avc is allowed in the current policy
allow unconfined_t secure_app_data_t:file { getattr relabelfrom relabelto };

#!!!! This avc is allowed in the current policy
allow unconfined_t secure_app_exec_t:file entrypoint;

#!!!! This avc is allowed in the current policy
allow unconfined_t secure_app_t:dir relabelto;

#!!!! This avc is allowed in the current policy
allow unconfined_t secure_app_t:file { execute relabelfrom relabelto };

#!!!! This avc is allowed in the current policy
allow unconfined_t self:capability2 mac_admin;
allow unconfined_t shell_exec_t:process transition;
